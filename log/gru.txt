======================================================================
ICE-NODE Training - Standard ODE Implementation
======================================================================
Device: cpu
Model: GRUBaseline
Dataset: mimic3
Time representation: global
Loss: Weighted BCE with automatic pos_weight (sqrt of imbalance ratio)
Regularization: NONE
Learning rates: dynamics=7.15e-05, other=0.00114
LR decay: 0.3 with patience=5
Demographic features: Enhanced [gender, normalized_age, relative_duration]
======================================================================
mimic3_train: 2951 trajectories loaded (vocab=581)
mimic3_val: 632 trajectories loaded (vocab=581)
Training samples: 2951
Validation samples: 632

Code frequency statistics:
  Total codes in vocabulary: 581
  Codes with at least one occurrence: 465 (80.0%)
  Codes excluded (<3 occurrences): 162
  Codes eligible for quintiles (>= 3): 419
  Max occurrences for any code: 2987.0
  Quantile Q0 (0-20% label mass): 308 codes, freq range: 3.0-166.0, avg: 45.6
  Quantile Q1 (20-40% label mass): 59 codes, freq range: 173.0-334.0, avg: 235.8
  Quantile Q2 (40-60% label mass): 30 codes, freq range: 341.0-686.0, avg: 461.8
  Quantile Q3 (60-80% label mass): 15 codes, freq range: 698.0-1455.0, avg: 952.2
  Quantile Q4 (80-100% label mass): 7 codes, freq range: 1474.0-2987.0, avg: 2033.3

Class weight statistics:
  Min weight: 0.0454
  Max weight: 2.4834
  Mean weight: 1.0000

Total parameters: 430,881

Baseline model: Using single learning rate (lr=1.14e-03)

Epoch 1/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44735, 581]), targets=torch.Size([44735, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 183/308 codes had occurrences
  Quantile 0: 7/572 correct predictions
  Quantile 0 accuracy: 0.0228
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 33/645 correct predictions
  Quantile 1 accuracy: 0.0336
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 20/668 correct predictions
  Quantile 2 accuracy: 0.0270
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 17/684 correct predictions
  Quantile 3 accuracy: 0.0264
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 44/614 correct predictions
  Quantile 4 accuracy: 0.0926
Train Loss: 0.7021 (BCE: 0.7021, Reg: 0.0000)
  Train micro AUROC: 0.5794
  Train micro AUPRC: 0.0356
  Train macro AUROC: 0.3302
  Train macro AUPRC: 0.0085
  Train hits@10:     0.6898
  Train hits@15:     0.7457
  Train hits@5:     0.5664
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0228
    Q1 (20-40%): 0.0336
    Q2 (40-60%): 0.0270
    Q3 (60-80%): 0.0264
    Q4 (80-100%): 0.0926
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0157
    P1 (codes in Q1): 0.0636
    P2 (codes in Q2): 0.0314
    P3 (codes in Q3): 0.0365
    P4 (codes in Q4): 0.0782

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 48/71 correct predictions
  Quantile 3 accuracy: 0.6333
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 64/74 correct predictions
  Quantile 4 accuracy: 0.8571

Val Loss: 0.6514 (BCE: 0.6514)
  Val micro AUROC: 0.4994
  Val micro AUPRC: 0.0602
  Val macro AUROC: 0.1461
  Val macro AUPRC: 0.0096
  Val hits@10:     0.8636
  Val hits@15:     0.8958
  Val hits@5:     0.7390
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.6333
    Q4 (80-100%): 0.8571
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0625
    P3 (codes in Q3): 0.8732
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.4994)

Epoch 2/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42538, 581]), targets=torch.Size([42538, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 231/308 codes had occurrences
  Quantile 0: 0/1046 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/985 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/996 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 745/1111 correct predictions
  Quantile 3 accuracy: 0.5918
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 944/1052 correct predictions
  Quantile 4 accuracy: 0.8571
Train Loss: 0.9039 (BCE: 0.9039, Reg: 0.0000)
  Train micro AUROC: 0.4929
  Train micro AUPRC: 0.0611
  Train macro AUROC: 0.1449
  Train macro AUPRC: 0.0069
  Train hits@10:     0.8500
  Train hits@15:     0.8940
  Train hits@5:     0.7776
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5918
    Q4 (80-100%): 0.8571
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0412
    P3 (codes in Q3): 0.8596
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 43/71 correct predictions
  Quantile 3 accuracy: 0.5444
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.6307 (BCE: 0.6307)
  Val micro AUROC: 0.4951
  Val micro AUPRC: 0.0668
  Val macro AUROC: 0.1273
  Val macro AUPRC: 0.0087
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7830
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5444
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9014
    P4 (codes in Q4): 1.0000

Epoch 3/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42147, 581]), targets=torch.Size([42147, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 232/308 codes had occurrences
  Quantile 0: 0/1054 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1033 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1023 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 666/1071 correct predictions
  Quantile 3 accuracy: 0.5387
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 996/996 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.6185 (BCE: 0.6185, Reg: 0.0000)
  Train micro AUROC: 0.5004
  Train micro AUPRC: 0.0610
  Train macro AUROC: 0.1404
  Train macro AUPRC: 0.0064
  Train hits@10:     0.8358
  Train hits@15:     0.8940
  Train hits@5:     0.7590
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5387
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0147
    P3 (codes in Q3): 0.8964
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 46/71 correct predictions
  Quantile 3 accuracy: 0.5689
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 1.0769 (BCE: 1.0769)
  Val micro AUROC: 0.4865
  Val micro AUPRC: 0.0632
  Val macro AUROC: 0.1194
  Val macro AUPRC: 0.0079
  Val hits@10:     0.8389
  Val hits@15:     0.9044
  Val hits@5:     0.7755
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5689
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9155
    P4 (codes in Q4): 1.0000

Epoch 4/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43120, 581]), targets=torch.Size([43120, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 233/308 codes had occurrences
  Quantile 0: 0/970 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/998 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1037 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 679/1122 correct predictions
  Quantile 3 accuracy: 0.5354
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 983/983 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.6917 (BCE: 0.6917, Reg: 0.0000)
  Train micro AUROC: 0.5120
  Train micro AUPRC: 0.0601
  Train macro AUROC: 0.1355
  Train macro AUPRC: 0.0063
  Train hits@10:     0.8367
  Train hits@15:     0.8973
  Train hits@5:     0.7555
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5354
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0019
    P3 (codes in Q3): 0.8797
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 48/71 correct predictions
  Quantile 3 accuracy: 0.5778
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.5701 (BCE: 0.5701)
  Val micro AUROC: 0.5142
  Val micro AUPRC: 0.0638
  Val macro AUROC: 0.1193
  Val macro AUPRC: 0.0080
  Val hits@10:     0.8410
  Val hits@15:     0.8926
  Val hits@5:     0.7766
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5778
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8873
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.5142)

Epoch 5/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43334, 581]), targets=torch.Size([43334, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 180/308 codes had occurrences
  Quantile 0: 0/484 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/478 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/553 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 353/542 correct predictions
  Quantile 3 accuracy: 0.5307
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 401/401 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.5689 (BCE: 0.5689, Reg: 0.0000)
  Train micro AUROC: 0.5216
  Train micro AUPRC: 0.0600
  Train macro AUROC: 0.1331
  Train macro AUPRC: 0.0061
  Train hits@10:     0.8358
  Train hits@15:     0.8926
  Train hits@5:     0.7515
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5307
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9336
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 46/71 correct predictions
  Quantile 3 accuracy: 0.5333
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.6171 (BCE: 0.6171)
  Val micro AUROC: 0.5121
  Val micro AUPRC: 0.0626
  Val macro AUROC: 0.1169
  Val macro AUPRC: 0.0080
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7734
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5333
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8873
    P4 (codes in Q4): 1.0000

Epoch 6/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44451, 581]), targets=torch.Size([44451, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 196/308 codes had occurrences
  Quantile 0: 0/511 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/533 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/543 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 389/634 correct predictions
  Quantile 3 accuracy: 0.5373
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 549/549 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.5022 (BCE: 0.5022, Reg: 0.0000)
  Train micro AUROC: 0.5480
  Train micro AUPRC: 0.0579
  Train macro AUROC: 0.1359
  Train macro AUPRC: 0.0063
  Train hits@10:     0.8358
  Train hits@15:     0.8959
  Train hits@5:     0.7536
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5373
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0020
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0018
    P3 (codes in Q3): 0.8801
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5889
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.4658 (BCE: 0.4658)
  Val micro AUROC: 0.5527
  Val micro AUPRC: 0.0597
  Val macro AUROC: 0.1223
  Val macro AUPRC: 0.0087
  Val hits@10:     0.8389
  Val hits@15:     0.8861
  Val hits@5:     0.7755
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5889
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8592
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.5527)

Epoch 7/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44777, 581]), targets=torch.Size([44777, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 233/308 codes had occurrences
  Quantile 0: 0/1043 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1078 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1046 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 734/1149 correct predictions
  Quantile 3 accuracy: 0.5407
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1045/1045 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.4407 (BCE: 0.4407, Reg: 0.0000)
  Train micro AUROC: 0.5571
  Train micro AUPRC: 0.0558
  Train macro AUROC: 0.1366
  Train macro AUPRC: 0.0064
  Train hits@10:     0.8358
  Train hits@15:     0.8940
  Train hits@5:     0.7569
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5407
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0019
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8451
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 42/71 correct predictions
  Quantile 3 accuracy: 0.4756
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.4064 (BCE: 0.4064)
  Val micro AUROC: 0.6089
  Val micro AUPRC: 0.0611
  Val macro AUROC: 0.1342
  Val macro AUPRC: 0.0100
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7658
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.4756
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8310
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.6089)

Epoch 8/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([40141, 581]), targets=torch.Size([40141, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 216/308 codes had occurrences
  Quantile 0: 0/891 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/943 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/962 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 610/1094 correct predictions
  Quantile 3 accuracy: 0.4742
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 992/992 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.3844 (BCE: 0.3844, Reg: 0.0000)
  Train micro AUROC: 0.6556
  Train micro AUPRC: 0.0595
  Train macro AUROC: 0.1805
  Train macro AUPRC: 0.0081
  Train hits@10:     0.8358
  Train hits@15:     0.8803
  Train hits@5:     0.7480
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.4742
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0045
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.7751
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 33/71 correct predictions
  Quantile 3 accuracy: 0.3611
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.3455 (BCE: 0.3455)
  Val micro AUROC: 0.6155
  Val micro AUPRC: 0.0579
  Val macro AUROC: 0.1422
  Val macro AUPRC: 0.0118
  Val hits@10:     0.8389
  Val hits@15:     0.8776
  Val hits@5:     0.7734
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.3611
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.6761
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.6155)

Epoch 9/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([39145, 581]), targets=torch.Size([39145, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 259/308 codes had occurrences
  Quantile 0: 3/1440 correct predictions
  Quantile 0 accuracy: 0.0030
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1461 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1477 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 731/1551 correct predictions
  Quantile 3 accuracy: 0.3625
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1409/1409 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.3275 (BCE: 0.3275, Reg: 0.0000)
  Train micro AUROC: 0.6854
  Train micro AUPRC: 0.0623
  Train macro AUROC: 0.2132
  Train macro AUPRC: 0.0099
  Train hits@10:     0.8358
  Train hits@15:     0.8773
  Train hits@5:     0.7559
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0030
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.3625
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0083
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.6177
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 41/71 correct predictions
  Quantile 3 accuracy: 0.4867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.3067 (BCE: 0.3067)
  Val micro AUROC: 0.8540
  Val micro AUPRC: 0.0755
  Val macro AUROC: 0.5893
  Val macro AUPRC: 0.0238
  Val hits@10:     0.8389
  Val hits@15:     0.8786
  Val hits@5:     0.7916
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.4867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.8169
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.8540)

Epoch 10/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([45773, 581]), targets=torch.Size([45773, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 219/308 codes had occurrences
  Quantile 0: 1/958 correct predictions
  Quantile 0 accuracy: 0.0046
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1009 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1007 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 582/1039 correct predictions
  Quantile 3 accuracy: 0.4885
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 926/926 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.2772 (BCE: 0.2772, Reg: 0.0000)
  Train micro AUROC: 0.8748
  Train micro AUPRC: 0.0764
  Train macro AUROC: 0.6323
  Train macro AUPRC: 0.0160
  Train hits@10:     0.8363
  Train hits@15:     0.8868
  Train hits@5:     0.7727
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0046
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.4885
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0021
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0089
    P3 (codes in Q3): 0.7786
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 45/71 correct predictions
  Quantile 3 accuracy: 0.5200
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.2540 (BCE: 0.2540)
  Val micro AUROC: 0.8547
  Val micro AUPRC: 0.0759
  Val macro AUROC: 0.5750
  Val macro AUPRC: 0.0221
  Val hits@10:     0.8389
  Val hits@15:     0.8840
  Val hits@5:     0.7873
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5200
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.8451
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.8547)

Epoch 11/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41677, 581]), targets=torch.Size([41677, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 244/308 codes had occurrences
  Quantile 0: 0/1295 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1225 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1293 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 829/1364 correct predictions
  Quantile 3 accuracy: 0.5171
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1176/1176 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.2617 (BCE: 0.2617, Reg: 0.0000)
  Train micro AUROC: 0.8555
  Train micro AUPRC: 0.0757
  Train macro AUROC: 0.5285
  Train macro AUPRC: 0.0143
  Train hits@10:     0.8361
  Train hits@15:     0.8887
  Train hits@5:     0.7671
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5171
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0008
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0131
    P3 (codes in Q3): 0.7977
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 42/71 correct predictions
  Quantile 3 accuracy: 0.5000
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.2247 (BCE: 0.2247)
  Val micro AUROC: 0.9547
  Val micro AUPRC: 0.0851
  Val macro AUROC: 0.9295
  Val macro AUPRC: 0.0214
  Val hits@10:     0.8400
  Val hits@15:     0.8851
  Val hits@5:     0.7680
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5000
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.8873
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.9547)

Epoch 12/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([39843, 581]), targets=torch.Size([39843, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 212/308 codes had occurrences
  Quantile 0: 0/789 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/888 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/836 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 578/960 correct predictions
  Quantile 3 accuracy: 0.5362
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 849/849 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.2171 (BCE: 0.2171, Reg: 0.0000)
  Train micro AUROC: 0.9562
  Train micro AUPRC: 0.0877
  Train macro AUROC: 0.8957
  Train macro AUPRC: 0.0154
  Train hits@10:     0.8479
  Train hits@15:     0.8901
  Train hits@5:     0.7722
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5362
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0108
    P3 (codes in Q3): 0.8552
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 43/71 correct predictions
  Quantile 3 accuracy: 0.5333
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1982 (BCE: 0.1982)
  Val micro AUROC: 0.9641
  Val micro AUPRC: 0.0862
  Val macro AUROC: 0.9316
  Val macro AUPRC: 0.0208
  Val hits@10:     0.8443
  Val hits@15:     0.8861
  Val hits@5:     0.7626
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5333
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9155
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.9641)

Epoch 13/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42403, 581]), targets=torch.Size([42403, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 209/308 codes had occurrences
  Quantile 0: 0/632 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/667 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/646 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 456/752 correct predictions
  Quantile 3 accuracy: 0.5088
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 692/692 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1805 (BCE: 0.1805, Reg: 0.0000)
  Train micro AUROC: 0.9377
  Train micro AUPRC: 0.0818
  Train macro AUROC: 0.8175
  Train macro AUPRC: 0.0152
  Train hits@10:     0.8521
  Train hits@15:     0.8903
  Train hits@5:     0.7757
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5088
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8697
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 43/71 correct predictions
  Quantile 3 accuracy: 0.5333
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.4600 (BCE: 0.4600)
  Val micro AUROC: 0.9173
  Val micro AUPRC: 0.0798
  Val macro AUROC: 0.7256
  Val macro AUPRC: 0.0209
  Val hits@10:     0.8443
  Val hits@15:     0.8861
  Val hits@5:     0.7583
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5333
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8873
    P4 (codes in Q4): 1.0000

Epoch 14/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([40625, 581]), targets=torch.Size([40625, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 264/308 codes had occurrences
  Quantile 0: 1/1899 correct predictions
  Quantile 0 accuracy: 0.0013
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1950 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1920 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 1214/2021 correct predictions
  Quantile 3 accuracy: 0.5220
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1837/1837 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.2000 (BCE: 0.2000, Reg: 0.0000)
  Train micro AUROC: 0.9571
  Train micro AUPRC: 0.0866
  Train macro AUROC: 0.8801
  Train macro AUPRC: 0.0154
  Train hits@10:     0.8405
  Train hits@15:     0.8901
  Train hits@5:     0.7767
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0013
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5220
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0016
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8600
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5644
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1685 (BCE: 0.1685)
  Val micro AUROC: 0.9727
  Val micro AUPRC: 0.0902
  Val macro AUROC: 0.9285
  Val macro AUPRC: 0.0210
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7626
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5644
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9155
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.9727)

Epoch 15/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44223, 581]), targets=torch.Size([44223, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 189/308 codes had occurrences
  Quantile 0: 0/555 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/591 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/571 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 386/637 correct predictions
  Quantile 3 accuracy: 0.5205
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 585/585 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1603 (BCE: 0.1603, Reg: 0.0000)
  Train micro AUROC: 0.9668
  Train micro AUPRC: 0.0872
  Train macro AUROC: 0.9017
  Train macro AUPRC: 0.0152
  Train hits@10:     0.8356
  Train hits@15:     0.8887
  Train hits@5:     0.7715
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5205
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0263
    P3 (codes in Q3): 0.8681
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5667
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1524 (BCE: 0.1524)
  Val micro AUROC: 0.9730
  Val micro AUPRC: 0.0876
  Val macro AUROC: 0.9326
  Val macro AUPRC: 0.0212
  Val hits@10:     0.8400
  Val hits@15:     0.8894
  Val hits@5:     0.7508
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5667
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.9730)

Epoch 16/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44465, 581]), targets=torch.Size([44465, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 226/308 codes had occurrences
  Quantile 0: 0/978 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/982 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1012 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 696/1094 correct predictions
  Quantile 3 accuracy: 0.5341
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 900/900 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1395 (BCE: 0.1395, Reg: 0.0000)
  Train micro AUROC: 0.9666
  Train micro AUPRC: 0.0864
  Train macro AUROC: 0.9116
  Train macro AUPRC: 0.0158
  Train hits@10:     0.8370
  Train hits@15:     0.8917
  Train hits@5:     0.7680
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5341
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0079
    P3 (codes in Q3): 0.8729
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5667
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.3021 (BCE: 0.3021)
  Val micro AUROC: 0.9652
  Val micro AUPRC: 0.0867
  Val macro AUROC: 0.9110
  Val macro AUPRC: 0.0212
  Val hits@10:     0.8410
  Val hits@15:     0.8926
  Val hits@5:     0.7497
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5667
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 17/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42552, 581]), targets=torch.Size([42552, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 192/308 codes had occurrences
  Quantile 0: 1/585 correct predictions
  Quantile 0 accuracy: 0.0010
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/612 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/635 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 395/622 correct predictions
  Quantile 3 accuracy: 0.5367
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 555/556 correct predictions
  Quantile 4 accuracy: 0.9979
Train Loss: 0.1479 (BCE: 0.1479, Reg: 0.0000)
  Train micro AUROC: 0.9698
  Train micro AUPRC: 0.0889
  Train macro AUROC: 0.9101
  Train macro AUPRC: 0.0153
  Train hits@10:     0.8372
  Train hits@15:     0.8929
  Train hits@5:     0.7734
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0010
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5367
    Q4 (80-100%): 0.9979
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0017
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0047
    P3 (codes in Q3): 0.8891
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5600
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1574 (BCE: 0.1574)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.0934
  Val macro AUROC: 0.9446
  Val macro AUPRC: 0.0239
  Val hits@10:     0.8400
  Val hits@15:     0.8894
  Val hits@5:     0.7637
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5600
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.9810)

Epoch 18/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42417, 581]), targets=torch.Size([42417, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 236/308 codes had occurrences
  Quantile 0: 1/1225 correct predictions
  Quantile 0 accuracy: 0.0042
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1195 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1283 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 855/1389 correct predictions
  Quantile 3 accuracy: 0.5317
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1258/1258 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1401 (BCE: 0.1401, Reg: 0.0000)
  Train micro AUROC: 0.9744
  Train micro AUPRC: 0.0916
  Train macro AUROC: 0.9192
  Train macro AUPRC: 0.0164
  Train hits@10:     0.8372
  Train hits@15:     0.8933
  Train hits@5:     0.7678
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0042
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5317
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0008
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8855
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5578
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1402 (BCE: 0.1402)
  Val micro AUROC: 0.9793
  Val micro AUPRC: 0.0927
  Val macro AUROC: 0.9492
  Val macro AUPRC: 0.0259
  Val hits@10:     0.8400
  Val hits@15:     0.8861
  Val hits@5:     0.7744
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5578
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 19/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41891, 581]), targets=torch.Size([41891, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 213/308 codes had occurrences
  Quantile 0: 1/904 correct predictions
  Quantile 0 accuracy: 0.0047
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/896 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/906 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 632/991 correct predictions
  Quantile 3 accuracy: 0.5366
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 913/913 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1611 (BCE: 0.1611, Reg: 0.0000)
  Train micro AUROC: 0.9724
  Train micro AUPRC: 0.0913
  Train macro AUROC: 0.9171
  Train macro AUPRC: 0.0159
  Train hits@10:     0.8354
  Train hits@15:     0.8931
  Train hits@5:     0.7585
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0047
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5366
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0011
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8930
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5622
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1622 (BCE: 0.1622)
  Val micro AUROC: 0.9801
  Val micro AUPRC: 0.0968
  Val macro AUROC: 0.9341
  Val macro AUPRC: 0.0213
  Val hits@10:     0.8389
  Val hits@15:     0.8894
  Val hits@5:     0.7658
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5622
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 20/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42957, 581]), targets=torch.Size([42957, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 205/308 codes had occurrences
  Quantile 0: 0/828 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/803 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/816 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 552/875 correct predictions
  Quantile 3 accuracy: 0.5328
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 762/762 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1442 (BCE: 0.1442, Reg: 0.0000)
  Train micro AUROC: 0.9736
  Train micro AUPRC: 0.0964
  Train macro AUROC: 0.9058
  Train macro AUPRC: 0.0151
  Train hits@10:     0.8347
  Train hits@15:     0.8915
  Train hits@5:     0.7606
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5328
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0037
    P3 (codes in Q3): 0.8949
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 46/71 correct predictions
  Quantile 3 accuracy: 0.5733
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1462 (BCE: 0.1462)
  Val micro AUROC: 0.9801
  Val micro AUPRC: 0.0974
  Val macro AUROC: 0.9339
  Val macro AUPRC: 0.0192
  Val hits@10:     0.8389
  Val hits@15:     0.8872
  Val hits@5:     0.7755
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5733
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 21/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41137, 581]), targets=torch.Size([41137, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 212/308 codes had occurrences
  Quantile 0: 0/740 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/771 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/819 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 566/871 correct predictions
  Quantile 3 accuracy: 0.5312
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 776/776 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1343 (BCE: 0.1343, Reg: 0.0000)
  Train micro AUROC: 0.9717
  Train micro AUPRC: 0.0928
  Train macro AUROC: 0.9107
  Train macro AUPRC: 0.0145
  Train hits@10:     0.8354
  Train hits@15:     0.8929
  Train hits@5:     0.7557
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5312
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0014
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0012
    P3 (codes in Q3): 0.9024
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 45/71 correct predictions
  Quantile 3 accuracy: 0.5600
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1279 (BCE: 0.1279)
  Val micro AUROC: 0.9776
  Val micro AUPRC: 0.0926
  Val macro AUROC: 0.9409
  Val macro AUPRC: 0.0200
  Val hits@10:     0.8389
  Val hits@15:     0.8872
  Val hits@5:     0.7755
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5600
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 22/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41137, 581]), targets=torch.Size([41137, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 198/308 codes had occurrences
  Quantile 0: 0/561 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/584 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/606 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 372/616 correct predictions
  Quantile 3 accuracy: 0.5335
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 538/538 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1532 (BCE: 0.1532, Reg: 0.0000)
  Train micro AUROC: 0.9703
  Train micro AUPRC: 0.0945
  Train macro AUROC: 0.9095
  Train macro AUPRC: 0.0151
  Train hits@10:     0.8361
  Train hits@15:     0.8933
  Train hits@5:     0.7564
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5335
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0018
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.8669
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 46/71 correct predictions
  Quantile 3 accuracy: 0.5733
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1342 (BCE: 0.1342)
  Val micro AUROC: 0.9774
  Val micro AUPRC: 0.1024
  Val macro AUROC: 0.9320
  Val macro AUPRC: 0.0220
  Val hits@10:     0.8400
  Val hits@15:     0.8883
  Val hits@5:     0.7476
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5733
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 23/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43725, 581]), targets=torch.Size([43725, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 159/308 codes had occurrences
  Quantile 0: 0/348 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 58/59 codes had occurrences
  Quantile 1: 0/338 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/357 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 256/399 correct predictions
  Quantile 3 accuracy: 0.5547
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 339/339 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1202 (BCE: 0.1202, Reg: 0.0000)
  Train micro AUROC: 0.9708
  Train micro AUPRC: 0.1006
  Train macro AUROC: 0.9111
  Train macro AUPRC: 0.0164
  Train hits@10:     0.8386
  Train hits@15:     0.8933
  Train hits@5:     0.7573
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5547
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0029
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0056
    P3 (codes in Q3): 0.9048
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.2536 (BCE: 0.2536)
  Val micro AUROC: 0.9762
  Val micro AUPRC: 0.0990
  Val macro AUROC: 0.9334
  Val macro AUPRC: 0.0208
  Val hits@10:     0.8400
  Val hits@15:     0.8883
  Val hits@5:     0.7465
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 24/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([40369, 581]), targets=torch.Size([40369, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 263/308 codes had occurrences
  Quantile 0: 0/1726 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1622 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1687 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 1156/1819 correct predictions
  Quantile 3 accuracy: 0.5453
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1676/1676 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1444 (BCE: 0.1444, Reg: 0.0000)
  Train micro AUROC: 0.9699
  Train micro AUPRC: 0.1022
  Train macro AUROC: 0.9081
  Train macro AUPRC: 0.0166
  Train hits@10:     0.8433
  Train hits@15:     0.8936
  Train hits@5:     0.7646
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5453
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0012
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0119
    P3 (codes in Q3): 0.8879
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 45/71 correct predictions
  Quantile 3 accuracy: 0.5600
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1351 (BCE: 0.1351)
  Val micro AUROC: 0.9803
  Val micro AUPRC: 0.1092
  Val macro AUROC: 0.9350
  Val macro AUPRC: 0.0226
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7508
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5600
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 25/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41933, 581]), targets=torch.Size([41933, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 227/308 codes had occurrences
  Quantile 0: 0/901 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/837 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/861 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 560/893 correct predictions
  Quantile 3 accuracy: 0.5381
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 798/798 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1323 (BCE: 0.1323, Reg: 0.0000)
  Train micro AUROC: 0.9743
  Train micro AUPRC: 0.1090
  Train macro AUROC: 0.9077
  Train macro AUPRC: 0.0177
  Train hits@10:     0.8461
  Train hits@15:     0.8938
  Train hits@5:     0.7741
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5381
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0302
    P3 (codes in Q3): 0.8914
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 45/71 correct predictions
  Quantile 3 accuracy: 0.5600
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1372 (BCE: 0.1372)
  Val micro AUROC: 0.9813
  Val micro AUPRC: 0.1104
  Val macro AUROC: 0.9366
  Val macro AUPRC: 0.0228
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7551
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5600
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.9813)

Epoch 26/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43562, 581]), targets=torch.Size([43562, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 223/308 codes had occurrences
  Quantile 0: 0/886 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/811 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/849 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 611/952 correct predictions
  Quantile 3 accuracy: 0.5477
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 848/848 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1277 (BCE: 0.1277, Reg: 0.0000)
  Train micro AUROC: 0.9759
  Train micro AUPRC: 0.1076
  Train macro AUROC: 0.9141
  Train macro AUPRC: 0.0177
  Train hits@10:     0.8463
  Train hits@15:     0.8943
  Train hits@5:     0.7755
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5477
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0283
    P3 (codes in Q3): 0.8782
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 45/71 correct predictions
  Quantile 3 accuracy: 0.5600
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1320 (BCE: 0.1320)
  Val micro AUROC: 0.9814
  Val micro AUPRC: 0.1077
  Val macro AUROC: 0.9392
  Val macro AUPRC: 0.0226
  Val hits@10:     0.8389
  Val hits@15:     0.8894
  Val hits@5:     0.7530
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5600
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000
Saved best model (MICRO-AUC=0.9814)

Epoch 27/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43483, 581]), targets=torch.Size([43483, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 203/308 codes had occurrences
  Quantile 0: 0/651 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/621 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/762 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 502/764 correct predictions
  Quantile 3 accuracy: 0.5395
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 675/675 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1177 (BCE: 0.1177, Reg: 0.0000)
  Train micro AUROC: 0.9760
  Train micro AUPRC: 0.1047
  Train macro AUROC: 0.9171
  Train macro AUPRC: 0.0176
  Train hits@10:     0.8456
  Train hits@15:     0.8943
  Train hits@5:     0.7755
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5395
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0289
    P3 (codes in Q3): 0.9084
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 46/71 correct predictions
  Quantile 3 accuracy: 0.5733
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1264 (BCE: 0.1264)
  Val micro AUROC: 0.9812
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9418
  Val macro AUPRC: 0.0229
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7530
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5733
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 28/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([40760, 581]), targets=torch.Size([40760, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 199/308 codes had occurrences
  Quantile 0: 0/610 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/554 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/579 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 406/649 correct predictions
  Quantile 3 accuracy: 0.5521
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 586/586 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1217 (BCE: 0.1217, Reg: 0.0000)
  Train micro AUROC: 0.9746
  Train micro AUPRC: 0.1015
  Train macro AUROC: 0.9162
  Train macro AUPRC: 0.0185
  Train hits@10:     0.8435
  Train hits@15:     0.8940
  Train hits@5:     0.7755
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5521
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0242
    P3 (codes in Q3): 0.8413
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1218 (BCE: 0.1218)
  Val micro AUROC: 0.9807
  Val micro AUPRC: 0.1016
  Val macro AUROC: 0.9446
  Val macro AUPRC: 0.0237
  Val hits@10:     0.8410
  Val hits@15:     0.8883
  Val hits@5:     0.7519
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 29/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43427, 581]), targets=torch.Size([43427, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 231/308 codes had occurrences
  Quantile 0: 0/1223 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1185 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1204 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 811/1261 correct predictions
  Quantile 3 accuracy: 0.5432
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1189/1189 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1131 (BCE: 0.1131, Reg: 0.0000)
  Train micro AUROC: 0.9754
  Train micro AUPRC: 0.0995
  Train macro AUROC: 0.9240
  Train macro AUPRC: 0.0186
  Train hits@10:     0.8400
  Train hits@15:     0.8952
  Train hits@5:     0.7729
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5432
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0241
    P3 (codes in Q3): 0.8898
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1178 (BCE: 0.1178)
  Val micro AUROC: 0.9801
  Val micro AUPRC: 0.0997
  Val macro AUROC: 0.9435
  Val macro AUPRC: 0.0247
  Val hits@10:     0.8400
  Val hits@15:     0.8894
  Val hits@5:     0.7519
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 30/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41989, 581]), targets=torch.Size([41989, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 217/308 codes had occurrences
  Quantile 0: 0/837 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/844 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/886 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 564/920 correct predictions
  Quantile 3 accuracy: 0.5370
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 797/797 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1368 (BCE: 0.1368, Reg: 0.0000)
  Train micro AUROC: 0.9746
  Train micro AUPRC: 0.0992
  Train macro AUROC: 0.9215
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8379
  Train hits@15:     0.8952
  Train hits@5:     0.7715
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5370
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0158
    P3 (codes in Q3): 0.8728
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1212 (BCE: 0.1212)
  Val micro AUROC: 0.9812
  Val micro AUPRC: 0.1034
  Val macro AUROC: 0.9404
  Val macro AUPRC: 0.0222
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7497
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 31/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42282, 581]), targets=torch.Size([42282, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 191/308 codes had occurrences
  Quantile 0: 0/614 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/681 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/649 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 439/660 correct predictions
  Quantile 3 accuracy: 0.5605
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 567/567 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1175 (BCE: 0.1175, Reg: 0.0000)
  Train micro AUROC: 0.9756
  Train micro AUPRC: 0.1029
  Train macro AUROC: 0.9150
  Train macro AUPRC: 0.0172
  Train hits@10:     0.8370
  Train hits@15:     0.8950
  Train hits@5:     0.7734
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5605
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0308
    P3 (codes in Q3): 0.9061
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1213 (BCE: 0.1213)
  Val micro AUROC: 0.9812
  Val micro AUPRC: 0.1049
  Val macro AUROC: 0.9380
  Val macro AUPRC: 0.0221
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7497
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 32/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41393, 581]), targets=torch.Size([41393, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 159/308 codes had occurrences
  Quantile 0: 0/431 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 58/59 codes had occurrences
  Quantile 1: 0/394 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/417 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 280/460 correct predictions
  Quantile 3 accuracy: 0.5440
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 347/347 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1176 (BCE: 0.1176, Reg: 0.0000)
  Train micro AUROC: 0.9750
  Train micro AUPRC: 0.1030
  Train macro AUROC: 0.9127
  Train macro AUPRC: 0.0171
  Train hits@10:     0.8370
  Train hits@15:     0.8950
  Train hits@5:     0.7718
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5440
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0096
    P3 (codes in Q3): 0.9043
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1363 (BCE: 0.1363)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1041
  Val macro AUROC: 0.9390
  Val macro AUPRC: 0.0221
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7508
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0312
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 33/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([39978, 581]), targets=torch.Size([39978, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 189/308 codes had occurrences
  Quantile 0: 0/652 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/705 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/654 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 426/659 correct predictions
  Quantile 3 accuracy: 0.5590
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 583/583 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1179 (BCE: 0.1179, Reg: 0.0000)
  Train micro AUROC: 0.9743
  Train micro AUPRC: 0.1027
  Train macro AUROC: 0.9112
  Train macro AUPRC: 0.0173
  Train hits@10:     0.8372
  Train hits@15:     0.8950
  Train hits@5:     0.7711
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5590
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0260
    P3 (codes in Q3): 0.9120
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1432 (BCE: 0.1432)
  Val micro AUROC: 0.9809
  Val micro AUPRC: 0.1038
  Val macro AUROC: 0.9396
  Val macro AUPRC: 0.0220
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7519
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 34/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43213, 581]), targets=torch.Size([43213, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 232/308 codes had occurrences
  Quantile 0: 0/1212 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1253 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1181 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 825/1298 correct predictions
  Quantile 3 accuracy: 0.5437
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1207/1207 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1080 (BCE: 0.1080, Reg: 0.0000)
  Train micro AUROC: 0.9758
  Train micro AUPRC: 0.1023
  Train macro AUROC: 0.9187
  Train macro AUPRC: 0.0173
  Train hits@10:     0.8372
  Train hits@15:     0.8950
  Train hits@5:     0.7713
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5437
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0127
    P3 (codes in Q3): 0.8883
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1499 (BCE: 0.1499)
  Val micro AUROC: 0.9808
  Val micro AUPRC: 0.1035
  Val macro AUROC: 0.9402
  Val macro AUPRC: 0.0222
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7540
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9437
    P4 (codes in Q4): 1.0000

Epoch 35/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43953, 581]), targets=torch.Size([43953, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 180/308 codes had occurrences
  Quantile 0: 0/528 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/590 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/540 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 405/642 correct predictions
  Quantile 3 accuracy: 0.5342
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 619/619 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1071 (BCE: 0.1071, Reg: 0.0000)
  Train micro AUROC: 0.9761
  Train micro AUPRC: 0.1019
  Train macro AUROC: 0.9208
  Train macro AUPRC: 0.0174
  Train hits@10:     0.8370
  Train hits@15:     0.8950
  Train hits@5:     0.7713
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5342
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0037
    P3 (codes in Q3): 0.9019
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1565 (BCE: 0.1565)
  Val micro AUROC: 0.9808
  Val micro AUPRC: 0.1033
  Val macro AUROC: 0.9408
  Val macro AUPRC: 0.0222
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7540
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 36/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41258, 581]), targets=torch.Size([41258, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 246/308 codes had occurrences
  Quantile 0: 0/1443 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1495 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1505 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 991/1589 correct predictions
  Quantile 3 accuracy: 0.5458
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1472/1472 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1142 (BCE: 0.1142, Reg: 0.0000)
  Train micro AUROC: 0.9748
  Train micro AUPRC: 0.1019
  Train macro AUROC: 0.9170
  Train macro AUPRC: 0.0174
  Train hits@10:     0.8372
  Train hits@15:     0.8947
  Train hits@5:     0.7711
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5458
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0033
    P3 (codes in Q3): 0.8968
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1633 (BCE: 0.1633)
  Val micro AUROC: 0.9807
  Val micro AUPRC: 0.1031
  Val macro AUROC: 0.9414
  Val macro AUPRC: 0.0222
  Val hits@10:     0.8389
  Val hits@15:     0.8904
  Val hits@5:     0.7551
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0156
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 37/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42096, 581]), targets=torch.Size([42096, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 234/308 codes had occurrences
  Quantile 0: 0/1132 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1180 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1148 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 797/1275 correct predictions
  Quantile 3 accuracy: 0.5392
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1136/1136 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1089 (BCE: 0.1089, Reg: 0.0000)
  Train micro AUROC: 0.9752
  Train micro AUPRC: 0.1017
  Train macro AUROC: 0.9193
  Train macro AUPRC: 0.0175
  Train hits@10:     0.8370
  Train hits@15:     0.8950
  Train hits@5:     0.7711
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5392
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0044
    P3 (codes in Q3): 0.8933
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1702 (BCE: 0.1702)
  Val micro AUROC: 0.9806
  Val micro AUPRC: 0.1030
  Val macro AUROC: 0.9397
  Val macro AUPRC: 0.0223
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 38/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43725, 581]), targets=torch.Size([43725, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 237/308 codes had occurrences
  Quantile 0: 0/1114 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1120 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1107 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 739/1166 correct predictions
  Quantile 3 accuracy: 0.5347
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1039/1039 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1179 (BCE: 0.1179, Reg: 0.0000)
  Train micro AUROC: 0.9759
  Train micro AUPRC: 0.1016
  Train macro AUROC: 0.9231
  Train macro AUPRC: 0.0177
  Train hits@10:     0.8370
  Train hits@15:     0.8947
  Train hits@5:     0.7708
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5347
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0099
    P3 (codes in Q3): 0.9005
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1337 (BCE: 0.1337)
  Val micro AUROC: 0.9808
  Val micro AUPRC: 0.1035
  Val macro AUROC: 0.9424
  Val macro AUPRC: 0.0224
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 39/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44479, 581]), targets=torch.Size([44479, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 197/308 codes had occurrences
  Quantile 0: 0/575 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/602 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/641 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 479/688 correct predictions
  Quantile 3 accuracy: 0.5482
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 637/637 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1038 (BCE: 0.1038, Reg: 0.0000)
  Train micro AUROC: 0.9765
  Train micro AUPRC: 0.1022
  Train macro AUROC: 0.9244
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8372
  Train hits@15:     0.8947
  Train hits@5:     0.7706
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5482
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0109
    P3 (codes in Q3): 0.9259
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1306 (BCE: 0.1306)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1039
  Val macro AUROC: 0.9423
  Val macro AUPRC: 0.0225
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 40/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41798, 581]), targets=torch.Size([41798, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 218/308 codes had occurrences
  Quantile 0: 0/747 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/778 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/773 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 525/857 correct predictions
  Quantile 3 accuracy: 0.5377
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 780/780 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1129 (BCE: 0.1129, Reg: 0.0000)
  Train micro AUROC: 0.9754
  Train micro AUPRC: 0.1026
  Train macro AUROC: 0.9197
  Train macro AUPRC: 0.0178
  Train hits@10:     0.8372
  Train hits@15:     0.8947
  Train hits@5:     0.7704
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5377
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0052
    P3 (codes in Q3): 0.9125
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1311 (BCE: 0.1311)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1040
  Val macro AUROC: 0.9424
  Val macro AUPRC: 0.0225
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 41/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([46890, 581]), targets=torch.Size([46890, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 214/308 codes had occurrences
  Quantile 0: 0/774 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/851 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/812 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 568/887 correct predictions
  Quantile 3 accuracy: 0.5386
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 818/818 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1004 (BCE: 0.1004, Reg: 0.0000)
  Train micro AUROC: 0.9775
  Train micro AUPRC: 0.1023
  Train macro AUROC: 0.9283
  Train macro AUPRC: 0.0178
  Train hits@10:     0.8372
  Train hits@15:     0.8947
  Train hits@5:     0.7704
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5386
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0123
    P3 (codes in Q3): 0.9177
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1326 (BCE: 0.1326)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1039
  Val macro AUROC: 0.9425
  Val macro AUPRC: 0.0226
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 42/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([37148, 581]), targets=torch.Size([37148, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 187/308 codes had occurrences
  Quantile 0: 1/543 correct predictions
  Quantile 0 accuracy: 0.0053
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/564 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/511 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 354/577 correct predictions
  Quantile 3 accuracy: 0.5266
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 510/510 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1221 (BCE: 0.1221, Reg: 0.0000)
  Train micro AUROC: 0.9730
  Train micro AUPRC: 0.1028
  Train macro AUROC: 0.9103
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8372
  Train hits@15:     0.8947
  Train hits@5:     0.7704
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0053
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5266
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0018
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0117
    P3 (codes in Q3): 0.8735
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1345 (BCE: 0.1345)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1039
  Val macro AUROC: 0.9427
  Val macro AUPRC: 0.0226
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 43/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([40867, 581]), targets=torch.Size([40867, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 172/308 codes had occurrences
  Quantile 0: 0/461 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 58/59 codes had occurrences
  Quantile 1: 0/418 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/503 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 343/548 correct predictions
  Quantile 3 accuracy: 0.5617
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 451/451 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1139 (BCE: 0.1139, Reg: 0.0000)
  Train micro AUROC: 0.9750
  Train micro AUPRC: 0.1026
  Train macro AUROC: 0.9187
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8372
  Train hits@15:     0.8947
  Train hits@5:     0.7704
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5617
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0060
    P3 (codes in Q3): 0.9033
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1366 (BCE: 0.1366)
  Val micro AUROC: 0.9809
  Val micro AUPRC: 0.1039
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0226
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 44/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([45731, 581]), targets=torch.Size([45731, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 213/308 codes had occurrences
  Quantile 0: 0/831 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/826 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/844 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 543/891 correct predictions
  Quantile 3 accuracy: 0.5415
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 788/788 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1035 (BCE: 0.1035, Reg: 0.0000)
  Train micro AUROC: 0.9771
  Train micro AUPRC: 0.1026
  Train macro AUROC: 0.9268
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8370
  Train hits@15:     0.8950
  Train hits@5:     0.7706
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5415
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0118
    P3 (codes in Q3): 0.8979
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1375 (BCE: 0.1375)
  Val micro AUROC: 0.9811
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9426
  Val macro AUPRC: 0.0226
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 45/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([39024, 581]), targets=torch.Size([39024, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 211/308 codes had occurrences
  Quantile 0: 0/940 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/907 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/932 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 700/1060 correct predictions
  Quantile 3 accuracy: 0.5564
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 954/954 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1135 (BCE: 0.1135, Reg: 0.0000)
  Train micro AUROC: 0.9741
  Train micro AUPRC: 0.1033
  Train macro AUROC: 0.9143
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5564
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0054
    P3 (codes in Q3): 0.9113
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1381 (BCE: 0.1381)
  Val micro AUROC: 0.9811
  Val micro AUPRC: 0.1045
  Val macro AUROC: 0.9426
  Val macro AUPRC: 0.0226
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 46/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44912, 581]), targets=torch.Size([44912, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 249/308 codes had occurrences
  Quantile 0: 2/1382 correct predictions
  Quantile 0 accuracy: 0.0025
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1284 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1334 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 872/1416 correct predictions
  Quantile 3 accuracy: 0.5412
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1325/1325 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1009 (BCE: 0.1009, Reg: 0.0000)
  Train micro AUROC: 0.9768
  Train micro AUPRC: 0.1029
  Train macro AUROC: 0.9254
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0025
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5412
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0014
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0015
    P3 (codes in Q3): 0.8948
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1387 (BCE: 0.1387)
  Val micro AUROC: 0.9811
  Val micro AUPRC: 0.1045
  Val macro AUROC: 0.9426
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 47/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([45638, 581]), targets=torch.Size([45638, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 225/308 codes had occurrences
  Quantile 0: 0/953 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/912 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/948 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 665/1088 correct predictions
  Quantile 3 accuracy: 0.5278
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 977/977 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1017 (BCE: 0.1017, Reg: 0.0000)
  Train micro AUROC: 0.9771
  Train micro AUPRC: 0.1029
  Train macro AUROC: 0.9266
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5278
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0032
    P3 (codes in Q3): 0.9026
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1393 (BCE: 0.1393)
  Val micro AUROC: 0.9811
  Val micro AUPRC: 0.1045
  Val macro AUROC: 0.9426
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 48/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([44614, 581]), targets=torch.Size([44614, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 240/308 codes had occurrences
  Quantile 0: 0/1199 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1143 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1257 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 863/1339 correct predictions
  Quantile 3 accuracy: 0.5468
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1132/1132 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1025 (BCE: 0.1025, Reg: 0.0000)
  Train micro AUROC: 0.9767
  Train micro AUPRC: 0.1029
  Train macro AUROC: 0.9250
  Train macro AUPRC: 0.0179
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5468
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0040
    P3 (codes in Q3): 0.8992
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1399 (BCE: 0.1399)
  Val micro AUROC: 0.9811
  Val micro AUPRC: 0.1045
  Val macro AUROC: 0.9427
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 49/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([39978, 581]), targets=torch.Size([39978, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 235/308 codes had occurrences
  Quantile 0: 0/1072 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1098 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1084 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 717/1140 correct predictions
  Quantile 3 accuracy: 0.5372
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1084/1084 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1155 (BCE: 0.1155, Reg: 0.0000)
  Train micro AUROC: 0.9746
  Train micro AUPRC: 0.1032
  Train macro AUROC: 0.9166
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5372
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0046
    P3 (codes in Q3): 0.9088
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1405 (BCE: 0.1405)
  Val micro AUROC: 0.9811
  Val micro AUPRC: 0.1045
  Val macro AUROC: 0.9428
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 50/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([40481, 581]), targets=torch.Size([40481, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 227/308 codes had occurrences
  Quantile 0: 0/1047 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1085 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1110 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 711/1112 correct predictions
  Quantile 3 accuracy: 0.5454
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1113/1113 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1096 (BCE: 0.1096, Reg: 0.0000)
  Train micro AUROC: 0.9749
  Train micro AUPRC: 0.1032
  Train macro AUROC: 0.9177
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5454
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0054
    P3 (codes in Q3): 0.9038
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1412 (BCE: 0.1412)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9428
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 51/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43334, 581]), targets=torch.Size([43334, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 221/308 codes had occurrences
  Quantile 0: 0/796 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/832 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/766 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 545/846 correct predictions
  Quantile 3 accuracy: 0.5541
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 745/745 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1039 (BCE: 0.1039, Reg: 0.0000)
  Train micro AUROC: 0.9762
  Train micro AUPRC: 0.1030
  Train macro AUROC: 0.9231
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5541
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0039
    P3 (codes in Q3): 0.9137
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1414 (BCE: 0.1414)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9428
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 52/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42147, 581]), targets=torch.Size([42147, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 194/308 codes had occurrences
  Quantile 0: 0/592 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/620 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/626 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 499/730 correct predictions
  Quantile 3 accuracy: 0.5508
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 645/645 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1120 (BCE: 0.1120, Reg: 0.0000)
  Train micro AUROC: 0.9757
  Train micro AUPRC: 0.1030
  Train macro AUROC: 0.9210
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5508
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0176
    P3 (codes in Q3): 0.9068
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1416 (BCE: 0.1416)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9428
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 53/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([42785, 581]), targets=torch.Size([42785, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 212/308 codes had occurrences
  Quantile 0: 0/677 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/690 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/714 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 497/736 correct predictions
  Quantile 3 accuracy: 0.5663
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 624/624 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1034 (BCE: 0.1034, Reg: 0.0000)
  Train micro AUROC: 0.9759
  Train micro AUPRC: 0.1030
  Train macro AUROC: 0.9222
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5663
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0140
    P3 (codes in Q3): 0.9117
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1418 (BCE: 0.1418)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 54/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([39494, 581]), targets=torch.Size([39494, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 183/308 codes had occurrences
  Quantile 0: 0/543 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/518 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/533 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 302/504 correct predictions
  Quantile 3 accuracy: 0.5268
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 465/465 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1138 (BCE: 0.1138, Reg: 0.0000)
  Train micro AUROC: 0.9744
  Train micro AUPRC: 0.1032
  Train macro AUROC: 0.9159
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5268
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0038
    P3 (codes in Q3): 0.8988
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1420 (BCE: 0.1420)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 55/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([43525, 581]), targets=torch.Size([43525, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 248/308 codes had occurrences
  Quantile 0: 0/1378 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1492 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1428 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 985/1576 correct predictions
  Quantile 3 accuracy: 0.5404
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1375/1375 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1051 (BCE: 0.1051, Reg: 0.0000)
  Train micro AUROC: 0.9763
  Train micro AUPRC: 0.1030
  Train macro AUROC: 0.9235
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5404
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0014
    P3 (codes in Q3): 0.8959
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1422 (BCE: 0.1422)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 56/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([40355, 581]), targets=torch.Size([40355, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 239/308 codes had occurrences
  Quantile 0: 0/1379 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1312 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1287 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 908/1453 correct predictions
  Quantile 3 accuracy: 0.5414
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1362/1362 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1143 (BCE: 0.1143, Reg: 0.0000)
  Train micro AUROC: 0.9748
  Train micro AUPRC: 0.1031
  Train macro AUROC: 0.9177
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5414
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0031
    P3 (codes in Q3): 0.9071
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1424 (BCE: 0.1424)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 57/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41002, 581]), targets=torch.Size([41002, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 165/308 codes had occurrences
  Quantile 0: 0/423 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/416 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/445 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 316/491 correct predictions
  Quantile 3 accuracy: 0.5515
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 410/410 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1135 (BCE: 0.1135, Reg: 0.0000)
  Train micro AUROC: 0.9751
  Train micro AUPRC: 0.1031
  Train macro AUROC: 0.9190
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5515
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0022
    P3 (codes in Q3): 0.9267
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1425 (BCE: 0.1425)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 58/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([34844, 581]), targets=torch.Size([34844, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 233/308 codes had occurrences
  Quantile 0: 0/1190 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1099 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1104 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 799/1266 correct predictions
  Quantile 3 accuracy: 0.5440
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1118/1118 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1275 (BCE: 0.1275, Reg: 0.0000)
  Train micro AUROC: 0.9717
  Train micro AUPRC: 0.1035
  Train macro AUROC: 0.9050
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5440
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0063
    P3 (codes in Q3): 0.8965
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1425 (BCE: 0.1425)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 59/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([41421, 581]), targets=torch.Size([41421, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 193/308 codes had occurrences
  Quantile 0: 0/529 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/514 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/527 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 361/596 correct predictions
  Quantile 3 accuracy: 0.5305
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 547/547 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1111 (BCE: 0.1111, Reg: 0.0000)
  Train micro AUROC: 0.9753
  Train micro AUPRC: 0.1031
  Train macro AUROC: 0.9198
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5305
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0038
    P3 (codes in Q3): 0.8809
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1426 (BCE: 0.1426)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

Epoch 60/60
----------------------------------------------------------------------

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([38945, 581]), targets=torch.Size([38945, 581])
  Reshaping using 2951 admission lengths
  Reshaped to (2951, 581) admissions
  Computing top-15 predictions for 2951 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 234/308 codes had occurrences
  Quantile 0: 0/1096 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 59/59 codes had occurrences
  Quantile 1: 0/1131 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 30/30 codes had occurrences
  Quantile 2: 0/1074 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 725/1135 correct predictions
  Quantile 3 accuracy: 0.5412
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 1129/1129 correct predictions
  Quantile 4 accuracy: 1.0000
Train Loss: 0.1116 (BCE: 0.1116, Reg: 0.0000)
  Train micro AUROC: 0.9741
  Train micro AUPRC: 0.1032
  Train macro AUROC: 0.9148
  Train macro AUPRC: 0.0180
  Train hits@10:     0.8367
  Train hits@15:     0.8947
  Train hits@5:     0.7701
  Train Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5412
    Q4 (80-100%): 1.0000
  Train Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0084
    P3 (codes in Q3): 0.9084
    P4 (codes in Q4): 1.0000

Calculating per-code accuracy...
  Original tensor shapes: logits=torch.Size([13128, 581]), targets=torch.Size([13128, 581])
  Reshaping using 632 admission lengths
  Reshaped to (632, 581) admissions
  Computing top-15 predictions for 632 admissions
  Quantile 0: Found 308 codes
  Quantile 0: 58/308 codes had occurrences
  Quantile 0: 0/81 correct predictions
  Quantile 0 accuracy: 0.0000
  Quantile 1: Found 59 codes
  Quantile 1: 32/59 codes had occurrences
  Quantile 1: 0/57 correct predictions
  Quantile 1 accuracy: 0.0000
  Quantile 2: Found 30 codes
  Quantile 2: 22/30 codes had occurrences
  Quantile 2: 0/64 correct predictions
  Quantile 2 accuracy: 0.0000
  Quantile 3: Found 15 codes
  Quantile 3: 15/15 codes had occurrences
  Quantile 3: 47/71 correct predictions
  Quantile 3 accuracy: 0.5867
  Quantile 4: Found 7 codes
  Quantile 4: 7/7 codes had occurrences
  Quantile 4: 74/74 correct predictions
  Quantile 4 accuracy: 1.0000

Val Loss: 0.1427 (BCE: 0.1427)
  Val micro AUROC: 0.9810
  Val micro AUPRC: 0.1044
  Val macro AUROC: 0.9429
  Val macro AUPRC: 0.0227
  Val hits@10:     0.8389
  Val hits@15:     0.8915
  Val hits@5:     0.7573
  Val Per-code accuracy @15 by frequency (Paper Table 2):
    Q0 ( 0-20%): 0.0000
    Q1 (20-40%): 0.0000
    Q2 (40-60%): 0.0000
    Q3 (60-80%): 0.5867
    Q4 (80-100%): 1.0000
  Val Detectability ACC-Pi-k20 by frequency (ICE-NODE metric):
    P0 (codes in Q0): 0.0000
    P1 (codes in Q1): 0.0000
    P2 (codes in Q2): 0.0000
    P3 (codes in Q3): 0.9296
    P4 (codes in Q4): 1.0000

======================================================================
Training completed! Best validation MICRO-AUC: 0.9814
======================================================================
